2025-04-19 20:14:14,145 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionOnly', cluster_E=False, cluster_F=False, batch_size=4096, num_epochs=1000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-19 20:15:01,295 INFO Loaded x shape (620000, 16, 3), y shape (620000, 5)
2025-04-19 20:15:02,731 INFO Split into train (496000, 16, 3) and val (124000, 16, 3)
2025-04-19 20:15:05,634 INFO Model: "model"
2025-04-19 20:15:05,635 INFO _________________________________________________________________
2025-04-19 20:15:05,635 INFO  Layer (type)                Output Shape              Param #   
2025-04-19 20:15:05,635 INFO =================================================================
2025-04-19 20:15:05,635 INFO  input_1 (InputLayer)        [(None, 16, 3)]           0         
2025-04-19 20:15:05,635 INFO                                                                  
2025-04-19 20:15:05,635 INFO  dense (Dense)               (None, 16, 16)            64        
2025-04-19 20:15:05,635 INFO                                                                  
2025-04-19 20:15:05,636 INFO  linformer_transformer_bloc  (None, 16, 16)            3636      
2025-04-19 20:15:05,636 INFO  k (LinformerTransformerBlo                                      
2025-04-19 20:15:05,636 INFO  ck)                                                             
2025-04-19 20:15:05,636 INFO                                                                  
2025-04-19 20:15:05,636 INFO  aggregation_layer (Aggrega  (None, 16)                0         
2025-04-19 20:15:05,636 INFO  tionLayer)                                                      
2025-04-19 20:15:05,636 INFO                                                                  
2025-04-19 20:15:05,636 INFO  dense_3 (Dense)             (None, 16)                272       
2025-04-19 20:15:05,636 INFO                                                                  
2025-04-19 20:15:05,636 INFO  dense_4 (Dense)             (None, 5)                 85        
2025-04-19 20:15:05,637 INFO                                                                  
2025-04-19 20:15:05,637 INFO =================================================================
2025-04-19 20:15:05,638 INFO Total params: 4057 (15.85 KB)
2025-04-19 20:15:05,638 INFO Trainable params: 4057 (15.85 KB)
2025-04-19 20:15:05,638 INFO Non-trainable params: 0 (0.00 Byte)
2025-04-19 20:15:05,638 INFO _________________________________________________________________
2025-04-19 20:19:22,412 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionOnly', cluster_E=False, cluster_F=False, batch_size=4096, num_epochs=1000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-19 20:19:27,173 INFO Loaded x shape (620000, 16, 3), y shape (620000, 5)
2025-04-19 20:19:27,900 INFO Split into train (496000, 16, 3) and val (124000, 16, 3)
2025-04-19 20:19:29,971 INFO Model: "model"
2025-04-19 20:19:29,971 INFO _________________________________________________________________
2025-04-19 20:19:29,971 INFO  Layer (type)                Output Shape              Param #   
2025-04-19 20:19:29,971 INFO =================================================================
2025-04-19 20:19:29,972 INFO  input_1 (InputLayer)        [(None, 16, 3)]           0         
2025-04-19 20:19:29,972 INFO                                                                  
2025-04-19 20:19:29,972 INFO  dense (Dense)               (None, 16, 16)            64        
2025-04-19 20:19:29,972 INFO                                                                  
2025-04-19 20:19:29,972 INFO  linformer_transformer_bloc  (None, 16, 16)            3636      
2025-04-19 20:19:29,972 INFO  k (LinformerTransformerBlo                                      
2025-04-19 20:19:29,972 INFO  ck)                                                             
2025-04-19 20:19:29,972 INFO                                                                  
2025-04-19 20:19:29,972 INFO  aggregation_layer (Aggrega  (None, 16)                0         
2025-04-19 20:19:29,973 INFO  tionLayer)                                                      
2025-04-19 20:19:29,973 INFO                                                                  
2025-04-19 20:19:29,973 INFO  dense_3 (Dense)             (None, 16)                272       
2025-04-19 20:19:29,973 INFO                                                                  
2025-04-19 20:19:29,973 INFO  dense_4 (Dense)             (None, 5)                 85        
2025-04-19 20:19:29,973 INFO                                                                  
2025-04-19 20:19:29,973 INFO =================================================================
2025-04-19 20:19:29,974 INFO Total params: 4057 (15.85 KB)
2025-04-19 20:19:29,974 INFO Trainable params: 4057 (15.85 KB)
2025-04-19 20:19:29,974 INFO Non-trainable params: 0 (0.00 Byte)
2025-04-19 20:19:29,974 INFO _________________________________________________________________
2025-04-19 21:24:17,169 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionOnly', cluster_E=False, cluster_F=False, batch_size=4096, num_epochs=1000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-19 21:24:20,688 INFO Loaded x shape (620000, 16, 3), y shape (620000, 5)
2025-04-19 21:24:29,496 INFO Split into train (496000, 16, 3) and val (124000, 16, 3)
2025-04-19 21:24:45,076 INFO Model: "model"
2025-04-19 21:24:45,076 INFO _________________________________________________________________
2025-04-19 21:24:45,077 INFO  Layer (type)                Output Shape              Param #   
2025-04-19 21:24:45,077 INFO =================================================================
2025-04-19 21:24:45,079 INFO  input_1 (InputLayer)        [(None, 16, 3)]           0         
2025-04-19 21:24:45,079 INFO                                                                  
2025-04-19 21:24:45,080 INFO  dense (Dense)               (None, 16, 16)            64        
2025-04-19 21:24:45,081 INFO                                                                  
2025-04-19 21:24:45,084 INFO  linformer_transformer_bloc  (None, 16, 16)            3636      
2025-04-19 21:24:45,085 INFO  k (LinformerTransformerBlo                                      
2025-04-19 21:24:45,085 INFO  ck)                                                             
2025-04-19 21:24:45,085 INFO                                                                  
2025-04-19 21:24:45,086 INFO  aggregation_layer (Aggrega  (None, 16)                0         
2025-04-19 21:24:45,086 INFO  tionLayer)                                                      
2025-04-19 21:24:45,087 INFO                                                                  
2025-04-19 21:24:45,088 INFO  dense_3 (Dense)             (None, 16)                272       
2025-04-19 21:24:45,088 INFO                                                                  
2025-04-19 21:24:45,089 INFO  dense_4 (Dense)             (None, 5)                 85        
2025-04-19 21:24:45,089 INFO                                                                  
2025-04-19 21:24:45,090 INFO =================================================================
2025-04-19 21:24:45,096 INFO Total params: 4057 (15.85 KB)
2025-04-19 21:24:45,097 INFO Trainable params: 4057 (15.85 KB)
2025-04-19 21:24:45,097 INFO Non-trainable params: 0 (0.00 Byte)
2025-04-19 21:24:45,097 INFO _________________________________________________________________
2025-04-19 23:06:04,556 INFO Saved weights to ../runs/convolutionOnly/16/pt/model.weights.h5
2025-04-19 23:06:04,693 INFO Saved history metrics to .npy files
2025-04-19 23:06:06,815 WARNING From /opt/conda/lib/python3.11/site-packages/tensorflow/python/profiler/internal/flops_registry.py:453: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This API was designed for TensorFlow v1. See https://www.tensorflow.org/guide/migrate for instructions on how to migrate your code to TensorFlow v2.
2025-04-19 23:06:06,908 INFO FLOPs per inference: 76494
2025-04-19 23:06:09,651 INFO Avg inference time per event (ns): 24795.169
2025-04-19 23:06:13,177 INFO Validation accuracy: 0.7269
2025-04-19 23:06:16,123 INFO Saved training curves
2025-04-19 23:06:20,418 INFO 1/FPR@TPR=0.8 for g: 5.718
2025-04-19 23:06:20,419 INFO 1/FPR@TPR=0.8 for q: 6.344
2025-04-19 23:06:20,419 INFO 1/FPR@TPR=0.8 for W: 14.576
2025-04-19 23:06:20,420 INFO 1/FPR@TPR=0.8 for Z: 12.852
2025-04-19 23:06:20,420 INFO 1/FPR@TPR=0.8 for t: 17.282
2025-04-19 23:06:20,421 INFO Average 1/FPR: 11.354
2025-04-20 03:00:51,486 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionOnly', cluster_E=False, cluster_F=False, batch_size=4096, num_epochs=1000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-20 03:11:10,852 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionOnly', cluster_E=False, cluster_F=False, batch_size=2048, num_epochs=2000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-20 03:23:02,013 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionOnly', cluster_E=False, cluster_F=False, batch_size=2048, num_epochs=2000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-20 03:23:06,957 INFO Loaded x shape (620000, 16, 3), y shape (620000, 5)
2025-04-20 03:23:07,476 INFO Split into train (496000, 16, 3) and val (124000, 16, 3)
2025-04-20 03:23:09,081 INFO Model: "model"
2025-04-20 03:23:09,081 INFO _________________________________________________________________
2025-04-20 03:23:09,081 INFO  Layer (type)                Output Shape              Param #   
2025-04-20 03:23:09,081 INFO =================================================================
2025-04-20 03:23:09,081 INFO  input_1 (InputLayer)        [(None, 16, 3)]           0         
2025-04-20 03:23:09,081 INFO                                                                  
2025-04-20 03:23:09,081 INFO  dense (Dense)               (None, 16, 16)            64        
2025-04-20 03:23:09,081 INFO                                                                  
2025-04-20 03:23:09,081 INFO  linformer_transformer_bloc  (None, 16, 16)            3636      
2025-04-20 03:23:09,081 INFO  k (LinformerTransformerBlo                                      
2025-04-20 03:23:09,081 INFO  ck)                                                             
2025-04-20 03:23:09,081 INFO                                                                  
2025-04-20 03:23:09,082 INFO  aggregation_layer (Aggrega  (None, 16)                0         
2025-04-20 03:23:09,082 INFO  tionLayer)                                                      
2025-04-20 03:23:09,082 INFO                                                                  
2025-04-20 03:23:09,082 INFO  dense_3 (Dense)             (None, 16)                272       
2025-04-20 03:23:09,082 INFO                                                                  
2025-04-20 03:23:09,082 INFO  dense_4 (Dense)             (None, 5)                 85        
2025-04-20 03:23:09,082 INFO                                                                  
2025-04-20 03:23:09,082 INFO =================================================================
2025-04-20 03:23:09,082 INFO Total params: 4057 (15.85 KB)
2025-04-20 03:23:09,082 INFO Trainable params: 4057 (15.85 KB)
2025-04-20 03:23:09,082 INFO Non-trainable params: 0 (0.00 Byte)
2025-04-20 03:23:09,082 INFO _________________________________________________________________
