2025-04-19 20:14:15,866 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionCluster', cluster_E=True, cluster_F=True, batch_size=4096, num_epochs=1000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-19 20:14:19,913 INFO Loaded x shape (620000, 16, 3), y shape (620000, 5)
2025-04-19 20:14:20,657 INFO Split into train (496000, 16, 3) and val (124000, 16, 3)
2025-04-19 20:14:22,775 INFO Model: "model"
2025-04-19 20:14:22,776 INFO _________________________________________________________________
2025-04-19 20:14:22,776 INFO  Layer (type)                Output Shape              Param #   
2025-04-19 20:14:22,776 INFO =================================================================
2025-04-19 20:14:22,776 INFO  input_1 (InputLayer)        [(None, 16, 3)]           0         
2025-04-19 20:14:22,776 INFO                                                                  
2025-04-19 20:14:22,776 INFO  dense (Dense)               (None, 16, 16)            64        
2025-04-19 20:14:22,776 INFO                                                                  
2025-04-19 20:14:22,776 INFO  linformer_transformer_bloc  (None, 16, 16)            1716      
2025-04-19 20:14:22,777 INFO  k (LinformerTransformerBlo                                      
2025-04-19 20:14:22,777 INFO  ck)                                                             
2025-04-19 20:14:22,777 INFO                                                                  
2025-04-19 20:14:22,777 INFO  aggregation_layer (Aggrega  (None, 16)                0         
2025-04-19 20:14:22,777 INFO  tionLayer)                                                      
2025-04-19 20:14:22,777 INFO                                                                  
2025-04-19 20:14:22,777 INFO  dense_3 (Dense)             (None, 16)                272       
2025-04-19 20:14:22,777 INFO                                                                  
2025-04-19 20:14:22,777 INFO  dense_4 (Dense)             (None, 5)                 85        
2025-04-19 20:14:22,777 INFO                                                                  
2025-04-19 20:14:22,777 INFO =================================================================
2025-04-19 20:14:22,778 INFO Total params: 2137 (8.35 KB)
2025-04-19 20:14:22,778 INFO Trainable params: 2137 (8.35 KB)
2025-04-19 20:14:22,778 INFO Non-trainable params: 0 (0.00 Byte)
2025-04-19 20:14:22,778 INFO _________________________________________________________________
2025-04-19 20:19:22,489 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionCluster', cluster_E=True, cluster_F=True, batch_size=4096, num_epochs=1000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-19 20:19:35,675 INFO Loaded x shape (620000, 16, 3), y shape (620000, 5)
2025-04-19 20:19:36,800 INFO Split into train (496000, 16, 3) and val (124000, 16, 3)
2025-04-19 20:19:39,007 INFO Model: "model"
2025-04-19 20:19:39,007 INFO _________________________________________________________________
2025-04-19 20:19:39,008 INFO  Layer (type)                Output Shape              Param #   
2025-04-19 20:19:39,008 INFO =================================================================
2025-04-19 20:19:39,008 INFO  input_1 (InputLayer)        [(None, 16, 3)]           0         
2025-04-19 20:19:39,008 INFO                                                                  
2025-04-19 20:19:39,008 INFO  dense (Dense)               (None, 16, 16)            64        
2025-04-19 20:19:39,008 INFO                                                                  
2025-04-19 20:19:39,009 INFO  linformer_transformer_bloc  (None, 16, 16)            1716      
2025-04-19 20:19:39,009 INFO  k (LinformerTransformerBlo                                      
2025-04-19 20:19:39,009 INFO  ck)                                                             
2025-04-19 20:19:39,009 INFO                                                                  
2025-04-19 20:19:39,009 INFO  aggregation_layer (Aggrega  (None, 16)                0         
2025-04-19 20:19:39,009 INFO  tionLayer)                                                      
2025-04-19 20:19:39,009 INFO                                                                  
2025-04-19 20:19:39,009 INFO  dense_3 (Dense)             (None, 16)                272       
2025-04-19 20:19:39,009 INFO                                                                  
2025-04-19 20:19:39,009 INFO  dense_4 (Dense)             (None, 5)                 85        
2025-04-19 20:19:39,009 INFO                                                                  
2025-04-19 20:19:39,009 INFO =================================================================
2025-04-19 20:19:39,010 INFO Total params: 2137 (8.35 KB)
2025-04-19 20:19:39,010 INFO Trainable params: 2137 (8.35 KB)
2025-04-19 20:19:39,011 INFO Non-trainable params: 0 (0.00 Byte)
2025-04-19 20:19:39,011 INFO _________________________________________________________________
2025-04-19 20:19:41,654 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionCluster', cluster_E=True, cluster_F=True, batch_size=4096, num_epochs=1000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-19 20:19:46,746 INFO Loaded x shape (620000, 16, 3), y shape (620000, 5)
2025-04-19 20:19:48,121 INFO Split into train (496000, 16, 3) and val (124000, 16, 3)
2025-04-19 20:19:50,708 INFO Model: "model"
2025-04-19 20:19:50,957 INFO _________________________________________________________________
2025-04-19 20:19:51,209 INFO  Layer (type)                Output Shape              Param #   
2025-04-19 20:19:51,417 INFO =================================================================
2025-04-19 20:19:51,676 INFO  input_1 (InputLayer)        [(None, 16, 3)]           0         
2025-04-19 20:19:51,884 INFO                                                                  
2025-04-19 20:19:52,159 INFO  dense (Dense)               (None, 16, 16)            64        
2025-04-19 20:19:52,375 INFO                                                                  
2025-04-19 20:19:52,586 INFO  linformer_transformer_bloc  (None, 16, 16)            1716      
2025-04-19 20:19:52,796 INFO  k (LinformerTransformerBlo                                      
2025-04-19 20:19:53,014 INFO  ck)                                                             
2025-04-19 20:19:53,236 INFO                                                                  
2025-04-19 20:19:53,488 INFO  aggregation_layer (Aggrega  (None, 16)                0         
2025-04-19 20:19:53,789 INFO  tionLayer)                                                      
2025-04-19 20:19:54,068 INFO                                                                  
2025-04-19 20:19:54,366 INFO  dense_3 (Dense)             (None, 16)                272       
2025-04-19 20:19:54,928 INFO                                                                  
2025-04-19 20:19:55,177 INFO  dense_4 (Dense)             (None, 5)                 85        
2025-04-19 20:19:55,398 INFO                                                                  
2025-04-19 20:19:55,625 INFO =================================================================
2025-04-19 20:19:55,862 INFO Total params: 2137 (8.35 KB)
2025-04-19 20:19:56,114 INFO Trainable params: 2137 (8.35 KB)
2025-04-19 20:19:56,380 INFO Non-trainable params: 0 (0.00 Byte)
2025-04-19 20:19:56,675 INFO _________________________________________________________________
2025-04-19 20:55:16,909 INFO Saved weights to ../runs/convolutionCluster/16/pt/model.weights.h5
2025-04-19 20:55:17,421 INFO Saved history metrics to .npy files
2025-04-19 20:55:17,802 WARNING From /opt/conda/lib/python3.11/site-packages/tensorflow/python/profiler/internal/flops_registry.py:453: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This API was designed for TensorFlow v1. See https://www.tensorflow.org/guide/migrate for instructions on how to migrate your code to TensorFlow v2.
2025-04-19 20:55:17,825 INFO FLOPs per inference: 76494
2025-04-19 20:55:18,202 INFO Avg inference time per event (ns): 3940.508
2025-04-19 20:55:18,858 INFO Validation accuracy: 0.7264
2025-04-19 20:55:19,684 INFO Saved training curves
2025-04-19 20:55:20,169 INFO 1/FPR@TPR=0.8 for g: 5.674
2025-04-19 20:55:20,169 INFO 1/FPR@TPR=0.8 for q: 6.197
2025-04-19 20:55:20,169 INFO 1/FPR@TPR=0.8 for W: 14.761
2025-04-19 20:55:20,169 INFO 1/FPR@TPR=0.8 for Z: 12.878
2025-04-19 20:55:20,169 INFO 1/FPR@TPR=0.8 for t: 17.620
2025-04-19 20:55:20,170 INFO Average 1/FPR: 11.426
2025-04-20 03:00:51,393 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionCluster', cluster_E=True, cluster_F=True, batch_size=4096, num_epochs=1000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-20 03:11:10,895 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionCluster', cluster_E=True, cluster_F=True, batch_size=2048, num_epochs=2000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-20 03:23:22,252 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionCluster', cluster_E=True, cluster_F=True, batch_size=2048, num_epochs=2000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-20 03:25:47,843 INFO Starting training with args: Namespace(data_dir='/j-jepa-vol/l1-jet-id/data/jetid/processed', save_dir='../runs/convolutionCluster', cluster_E=True, cluster_F=True, batch_size=2048, num_epochs=2000, d_model=16, d_ff=16, output_dim=16, num_heads=4, proj_dim=16, val_split=0.2, num_particles=16, sort_by='pt', convolution=True)
2025-04-20 03:25:52,576 INFO Loaded x shape (620000, 16, 3), y shape (620000, 5)
2025-04-20 03:25:53,084 INFO Split into train (496000, 16, 3) and val (124000, 16, 3)
2025-04-20 03:25:54,468 INFO Model: "model"
2025-04-20 03:25:54,468 INFO _________________________________________________________________
2025-04-20 03:25:54,469 INFO  Layer (type)                Output Shape              Param #   
2025-04-20 03:25:54,469 INFO =================================================================
2025-04-20 03:25:54,469 INFO  input_1 (InputLayer)        [(None, 16, 3)]           0         
2025-04-20 03:25:54,469 INFO                                                                  
2025-04-20 03:25:54,469 INFO  dense (Dense)               (None, 16, 16)            64        
2025-04-20 03:25:54,469 INFO                                                                  
2025-04-20 03:25:54,469 INFO  linformer_transformer_bloc  (None, 16, 16)            1716      
2025-04-20 03:25:54,469 INFO  k (LinformerTransformerBlo                                      
2025-04-20 03:25:54,469 INFO  ck)                                                             
2025-04-20 03:25:54,469 INFO                                                                  
2025-04-20 03:25:54,469 INFO  aggregation_layer (Aggrega  (None, 16)                0         
2025-04-20 03:25:54,469 INFO  tionLayer)                                                      
2025-04-20 03:25:54,469 INFO                                                                  
2025-04-20 03:25:54,469 INFO  dense_3 (Dense)             (None, 16)                272       
2025-04-20 03:25:54,469 INFO                                                                  
2025-04-20 03:25:54,469 INFO  dense_4 (Dense)             (None, 5)                 85        
2025-04-20 03:25:54,469 INFO                                                                  
2025-04-20 03:25:54,469 INFO =================================================================
2025-04-20 03:25:54,470 INFO Total params: 2137 (8.35 KB)
2025-04-20 03:25:54,470 INFO Trainable params: 2137 (8.35 KB)
2025-04-20 03:25:54,470 INFO Non-trainable params: 0 (0.00 Byte)
2025-04-20 03:25:54,470 INFO _________________________________________________________________
